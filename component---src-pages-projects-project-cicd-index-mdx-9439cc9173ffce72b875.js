(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{"013z":function(e,t,a){"use strict";var i=a("q1tI"),n=a.n(i),r=a("NmYn"),o=a.n(r),l=a("Wbzz"),c=a("Xrax"),s=a("k4MR"),b=a("TSYQ"),p=a.n(b),m=a("QH2O"),u=a.n(m),d=a("qKvR");var g=e=>{let{title:t,theme:a,tabs:i=[]}=e;return Object(d.b)("div",{className:p()(u.a.pageHeader,{[u.a.withTabs]:i.length,[u.a.darkMode]:"dark"===a})},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12"},Object(d.b)("h1",{id:"page-title",className:u.a.text},t)))))},h=a("BAC9");var O=e=>{let{relativePagePath:t,repository:a}=e;const{site:{siteMetadata:{repository:i}}}=Object(l.useStaticQuery)("1364590287"),{baseUrl:n,subDirectory:r,branch:o}=a||i,c=n+"/edit/"+o+r+"/src/pages"+t;return n?Object(d.b)("div",{className:"bx--row "+h.row},Object(d.b)("div",{className:"bx--col"},Object(d.b)("a",{className:h.link,href:c},"Edit this page on GitHub"))):null},j=a("FCXl"),f=a("dI71"),x=a("I8xM");var N=function(e){function t(){return e.apply(this,arguments)||this}return Object(f.a)(t,e),t.prototype.render=function(){const{title:e,tabs:t,slug:a}=this.props,i=a.split("/").filter(Boolean).slice(-1)[0],n=t.map(e=>{const t=o()(e,{lower:!0,strict:!0}),n=t===i,r=new RegExp(i+"/?(#.*)?$"),c=a.replace(r,t);return Object(d.b)("li",{key:e,className:p()({[x.selectedItem]:n},x.listItem)},Object(d.b)(l.Link,{className:x.link,to:""+c},e))});return Object(d.b)("div",{className:x.tabsContainer},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(d.b)("nav",{"aria-label":e},Object(d.b)("ul",{className:x.list},n))))))},t}(n.a.Component),y=a("MjG9"),w=a("CzIb"),k=a("Asxa"),A=a("OIbQ"),v=a.n(A);var T=e=>{let{date:t}=e;const a=new Date(t);return t?Object(d.b)(k.c,{className:v.a.row},Object(d.b)(k.a,null,Object(d.b)("div",{className:v.a.text},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null};t.a=e=>{let{pageContext:t,children:a,location:i,Title:n}=e;const{frontmatter:r={},relativePagePath:b,titleType:p}=t,{tabs:m,title:u,theme:h,description:f,keywords:x,date:k}=r,{interiorTheme:A}=Object(w.a)(),{site:{pathPrefix:v}}=Object(l.useStaticQuery)("2456312558"),C=v?i.pathname.replace(v,""):i.pathname,P=m?C.split("/").filter(Boolean).slice(-1)[0]||o()(m[0],{lower:!0}):"",I=h||A;return Object(d.b)(s.a,{tabs:m,homepage:!1,theme:I,pageTitle:u,pageDescription:f,pageKeywords:x,titleType:p},Object(d.b)(g,{title:n?Object(d.b)(n,null):u,label:"label",tabs:m,theme:I}),m&&Object(d.b)(N,{title:u,slug:C,tabs:m,currentTab:P}),Object(d.b)(y.a,{padded:!0},a,Object(d.b)(O,{relativePagePath:b}),Object(d.b)(T,{date:k})),Object(d.b)(j.a,{pageContext:t,location:i,slug:C,tabs:m,currentTab:P}),Object(d.b)(c.a,null))}},"2yob":function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return l})),a.d(t,"default",(function(){return b}));var i=a("wx14"),n=a("Ff2n"),r=(a("q1tI"),a("7ljp")),o=a("013z");a("qKvR");const l={},c={_frontmatter:l},s=o.a;function b(e){let{components:t}=e,a=Object(n.a)(e,["components"]);return Object(r.b)(s,Object(i.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",null,"Challenge"),Object(r.b)("p",null,"You are provided with the challenge to implement a demo that shows best practices for DevOps.\nImplement Continous Integration and Continous Deployment for an Application on Kubernetes."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Git repository with application code and Dockerfile, Developers have access to this git repository"),Object(r.b)("li",{parentName:"ul"},"Git repository with pipeline manifest files (ie yamls) files, Operators have access to this repository"),Object(r.b)("li",{parentName:"ul"},"Git repository with application manifest (ie yaml) files, automation only have access to this repository")),Object(r.b)("h2",null,"Specifications"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"818px"}},"\n      ",Object(r.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"31.59722222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQY021RuU4DMRDdH6ak5SP4Dor0NCAhAk3oSBQUEm3wsg7rPeI9fD/GjiIQYqTReObN+ZwhSvAwxpAJya0ZB1tuERJEmLWAd/grnjBHSZpgPSkY2SN7Gz1K5WC1gux7DOOAiguwnENrjXEcYZTCl7JYDR4hBMimoQU0lKY6PsPL+h3zuz3U8xOyq63GrJyguwairiCqA5SKzSXatkVRlvCDxG1xxOXG0MAJm/k9quID/WjAFxcQxSPV0Ja1QLbc7cFFnU46iB6MS1hr0naxcVRD77o7YpWzdCrLc0y0uXMO7LNB10k4b9FPEzJPxdae+Ll5ULieHSM7KRYLkkYe4wCiwxKfns4+Y3F4pCEkwgMynGyS9U5g8Vqc/ikl/ehv+S9+9r8BMYrNQ7ZZBPoAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(r.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"overview-diagram",title:"overview-diagram",src:"/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png",srcSet:["/static/e0f59cda603cd30cfc3a5138da9d879c/7fc1e/tekton-argocd.png 288w","/static/e0f59cda603cd30cfc3a5138da9d879c/a5df1/tekton-argocd.png 576w","/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png 818w"],sizes:"(max-width: 818px) 100vw, 818px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    "),Object(r.b)("h3",null,"Code Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code"},"Git repository with application code")),Object(r.b)("li",{parentName:"ul"},"Create a new git repository using this repo as ",Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code/generate"},"template")),Object(r.b)("li",{parentName:"ul"},"Use the ",Object(r.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the root of the repository to build a container image")),Object(r.b)("h3",null,"Infra Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra"},"Git repository with application manifest")),Object(r.b)("li",{parentName:"ul"},"Create a new git repository using this repo as ",Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra/generate"},"template")),Object(r.b)("li",{parentName:"ul"},"The directory ",Object(r.b)("inlineCode",{parentName:"li"},"ocp/yamls")," contains the application manifest files")),Object(r.b)("h3",null,"Pipeline Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Create new repository to store pipeline resources"),Object(r.b)("li",{parentName:"ul"},"Use the ServiceAccount ",Object(r.b)("inlineCode",{parentName:"li"},"pipeline")),Object(r.b)("li",{parentName:"ul"},"Use the following guide to create a Pipeline, Tasks, and secret:",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Create a pipeline, tasks, secrets on the target namespace"),Object(r.b)("li",{parentName:"ul"},"Git clone the source code from the App repo"),Object(r.b)("li",{parentName:"ul"},"Build a container image using the ",Object(r.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the repo"),Object(r.b)("li",{parentName:"ul"},"Tag the image using the 7 first characters of the git hash corresponding to last git commit"),Object(r.b)("li",{parentName:"ul"},"Push the container image into the internal image registry on the same namespace"),Object(r.b)("li",{parentName:"ul"},"Git clone the Infra git repo"),Object(r.b)("li",{parentName:"ul"},"Update the image on the deployment yaml with the new image id that has the tag with value of the git commit"),Object(r.b)("li",{parentName:"ul"},"Git commit the changes"),Object(r.b)("li",{parentName:"ul"},"Git push the changes to the infra git repo, this should trigger argocd to pickup any changes from the infra repo.")))),Object(r.b)("h2",null,"Hints"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"The secret contains the git username and token with permission ",Object(r.b)("inlineCode",{parentName:"li"},"repo")," that gives write access to the git infra repository"),Object(r.b)("li",{parentName:"ul"},"OpenShift 4 comes with an internal image registry you can push from a Tekton task"),Object(r.b)("li",{parentName:"ul"},"The image registry url contains the service name, port, namespace, image name and tag",Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre"},"image-registry.openshift-image-registry.svc:5000/my-namespace-app/image-name:my-tag\n"))),Object(r.b)("li",{parentName:"ul"},"The image registry only handles ssl/https connections, but it uses a self sign certificate"),Object(r.b)("li",{parentName:"ul"},"You need to ignore TLS-Verify to be able to succesfully push and ignore ssl errors for example using buildah set the flag ",Object(r.b)("inlineCode",{parentName:"li"},'--tls-verify="false"'))),Object(r.b)("h2",null,"Extra Credit"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Make the pipeline to run automatically every time new code gets pushed to the Code git repository",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Configure a Github Webhook using the new ",Object(r.b)("a",{parentName:"li",href:"https://github.com/tektoncd/triggers"},"Tekton Triggers")," listener and bindings")))),Object(r.b)("h2",null,"Solution"),Object(r.b)("p",null,"Here is one implementation as a ",Object(r.b)("a",{parentName:"p",href:"./solution"},"solution")))}b.isMDXComponent=!0},BAC9:function(e,t,a){e.exports={bxTextTruncateEnd:"EditLink-module--bx--text-truncate--end--2pqje",bxTextTruncateFront:"EditLink-module--bx--text-truncate--front--3_lIE",link:"EditLink-module--link--1qzW3",row:"EditLink-module--row--1B9Gk"}},I8xM:function(e,t,a){e.exports={bxTextTruncateEnd:"PageTabs-module--bx--text-truncate--end--267NA",bxTextTruncateFront:"PageTabs-module--bx--text-truncate--front--3xEQF",tabsContainer:"PageTabs-module--tabs-container--8N4k0",list:"PageTabs-module--list--3eFQc",listItem:"PageTabs-module--list-item--nUmtD",link:"PageTabs-module--link--1mDJ1",selectedItem:"PageTabs-module--selected-item--YPVr3"}},OIbQ:function(e,t,a){e.exports={bxTextTruncateEnd:"last-modified-date-module--bx--text-truncate--end--123zi",bxTextTruncateFront:"last-modified-date-module--bx--text-truncate--front--3xeKz",text:"last-modified-date-module--text--24m-4",row:"last-modified-date-module--row--2BquN"}},QH2O:function(e,t,a){e.exports={bxTextTruncateEnd:"PageHeader-module--bx--text-truncate--end--mZWeX",bxTextTruncateFront:"PageHeader-module--bx--text-truncate--front--3zvrI",pageHeader:"PageHeader-module--page-header--3hIan",darkMode:"PageHeader-module--dark-mode--hBrwL",withTabs:"PageHeader-module--with-tabs--3nKxA",text:"PageHeader-module--text--o9LFq"}}}]);
//# sourceMappingURL=component---src-pages-projects-project-cicd-index-mdx-9439cc9173ffce72b875.js.map